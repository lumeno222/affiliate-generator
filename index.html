<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Affiliate-Link Generator</title>
  <style>
    :root{
      --bg:#f4f7fb;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --brand:#0ea5e9;
      --brand-dark:#0284c7;
      --ok:#16a34a;
      --warn:#ef4444;
      --ring:rgba(14,165,233,.35);
      --shadow:0 8px 28px rgba(2,8,23,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;padding:24px;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      background:linear-gradient(180deg,#f7fbff 0%, #eef5fb 100%);
      color:var(--text);
      display:flex;align-items:center;justify-content:center;
    }
    .container{
      width:100%;max-width:620px;background:var(--card);
      border-radius:16px;padding:28px;box-shadow:var(--shadow);
      border:1px solid #eef2f7;
    }
    .header{
      display:flex;gap:12px;align-items:center;margin-bottom:18px;
    }
    .logo{
      width:40px;height:40px;border-radius:10px;
      background:linear-gradient(135deg,#0ea5e9, #22d3ee);
      display:grid;place-items:center;color:white;font-weight:800;
      letter-spacing:.5px;
    }
    h1{font-size:22px;margin:0}
    p.subtitle{margin:6px 0 0;color:var(--muted);font-size:14px}

    label{display:block;font-weight:600;margin:18px 0 8px}
    .field{
      position:relative;
    }
    input[type=text]{
      width:100%;padding:14px 14px 14px 44px;border:1px solid #e5e7eb;
      border-radius:12px;font-size:16px;outline:none;background:#fbfdff;
      transition:border .15s, box-shadow .15s;
    }
    input[type=text]:focus{
      border-color:var(--brand);
      box-shadow:0 0 0 4px var(--ring);
    }
    .prefix{
      position:absolute;left:12px;top:50%;transform:translateY(-50%);
      color:#9aa4b2;font-size:14px
    }

    .row{display:flex;gap:10px;flex-wrap:wrap}
    button{
      flex:1 0 auto;
      background:var(--brand);color:#fff;border:0;border-radius:10px;
      padding:12px 16px;font-size:15px;font-weight:600;cursor:pointer;
      transition:transform .04s ease, background .15s ease, opacity .15s;
    }
    button:hover{background:var(--brand-dark)}
    button:active{transform:translateY(1px)}
    button.secondary{
      background:#0f172a0d;color:#0f172a;
    }
    button.secondary:hover{background:#0f172a14}
    button:disabled{opacity:.5;cursor:not-allowed}

    .output{
      margin-top:16px;
    }
    .hint{font-size:12px;color:var(--muted);margin-top:6px}
    .error{color:var(--warn);font-size:13px;margin-top:8px;display:none}

    .toast{
      position:fixed;left:50%;bottom:22px;transform:translateX(-50%);
      background:#061727;color:#e6f7ff;border:1px solid #08324c;
      padding:10px 14px;border-radius:10px;box-shadow:var(--shadow);
      font-size:14px;display:none;
    }

    .badge{
      display:inline-block;font-size:12px;color:#065f46;background:#ecfdf5;
      border:1px solid #a7f3d0;border-radius:999px;padding:4px 8px;margin-left:6px;
    }

    .helper{
      background:#f8fafc;border:1px dashed #e5e7eb;border-radius:12px;
      padding:12px;margin-top:16px;color:#334155;font-size:13px;
    }

    .link-preview{
      display:flex;align-items:center;gap:8px;margin-top:10px;
      padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#fbfdff;
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size:13px;overflow:auto;
    }
  </style>
</head>
<body>
  <div class="container" role="main">
    <div class="header">
      <div class="logo" aria-hidden="true">AFF</div>
      <div>
        <h1>Affiliate-Link Generator</h1>
        <p class="subtitle">Gib deine <strong>Digistore24-ID</strong> ein und erhalte deinen persönlichen Link
          <span class="badge">monefy.biz</span>
        </p>
      </div>
    </div>

    <label for="affiliateId">Deine Digistore24-ID</label>
    <div class="field">
      <span class="prefix">@</span>
      <input id="affiliateId" type="text" placeholder="z. B. deinname123" autocomplete="username" inputmode="latin" maxlength="64" />
    </div>
    <div class="hint">Erlaubt: Buchstaben, Zahlen, Punkt, Unterstrich, Bindestrich.</div>
    <div id="err" class="error">Ungültige ID. Nur a-z, 0-9, ., _, - sind erlaubt.</div>

    <label for="affiliateLink" style="margin-top:18px">Dein Affiliate-Link</label>
    <input id="affiliateLink" type="text" readonly placeholder="Wird nach Eingabe generiert …" />

    <div class="link-preview" id="preview" style="display:none"></div>

    <div class="row" style="margin-top:14px">
      <button id="genBtn" type="button">Link generieren</button>
      <button id="copyBtn" type="button" class="secondary" disabled>Kopieren</button>
      <button id="openBtn" type="button" class="secondary" disabled>Öffnen</button>
    </div>

    <div class="helper">
      Tipp: Deine ID wird lokal im Browser gespeichert, damit du sie nicht jedes Mal neu eingeben musst. Es werden keine Daten an einen Server gesendet.
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">In die Zwischenablage kopiert.</div>

  <script>
    // --- Einstellungen ---
    const LINK_BASE = "https://www.monefy.biz/deinfo?aff="; // <- NEU

    // --- Elemente ---
    const idInput = document.getElementById("affiliateId");
    const linkOutput = document.getElementById("affiliateLink");
    const genBtn = document.getElementById("genBtn");
    const copyBtn = document.getElementById("copyBtn");
    const openBtn = document.getElementById("openBtn");
    const err = document.getElementById("err");
    const toast = document.getElementById("toast");
    const preview = document.getElementById("preview");

    // --- Helpers ---
    const showToast = (msg) => {
      toast.textContent = msg;
      toast.style.display = "block";
      setTimeout(()=> toast.style.display = "none", 1800);
    };

    const validId = (v) => /^[a-zA-Z0-9._-]+$/.test(v);

    const generateLink = () => {
      const raw = idInput.value.trim();
      if (!raw) {
        err.style.display = "block";
        err.textContent = "Bitte gib deine Digistore24-ID ein.";
        return;
      }
      if (!validId(raw)) {
        err.style.display = "block";
        err.textContent = "Ungültige ID. Erlaubt: a-z, 0-9, Punkt, Unterstrich, Bindestrich.";
        return;
      }
      err.style.display = "none";
      const id = encodeURIComponent(raw);
      const url = LINK_BASE + id;
      linkOutput.value = url;
      preview.style.display = "flex";
      preview.textContent = url;
      copyBtn.disabled = false;
      openBtn.disabled = false;
      // lokal merken
      try { localStorage.setItem("digistore_aff", raw); } catch(e){}
    };

    const copyLink = async () => {
      const v = linkOutput.value;
      if (!v) return;
      try {
        await navigator.clipboard.writeText(v);
        showToast("In die Zwischenablage kopiert.");
      } catch (e) {
        // Fallback
        linkOutput.select();
        document.execCommand("copy");
        showToast("Kopiert (Fallback).");
      }
    };

    const openLink = () => {
      const v = linkOutput.value;
      if (v) window.open(v, "_blank", "noopener,noreferrer");
    };

    // --- Events ---
    genBtn.addEventListener("click", generateLink);
    copyBtn.addEventListener("click", copyLink);
    openBtn.addEventListener("click", openLink);
    idInput.addEventListener("keydown", (e)=>{
      if (e.key === "Enter") generateLink();
    });
    idInput.addEventListener("input", ()=>{
      copyBtn.disabled = true;
      openBtn.disabled = true;
      linkOutput.value = "";
      preview.style.display = "none";
      err.style.display = "none";
    });

    // Prefill aus localStorage
    try {
      const saved = localStorage.getItem("digistore_aff");
      if (saved) {
        idInput.value = saved;
        generateLink();
      }
    } catch(e){}
  </script>
</body>
</html>
